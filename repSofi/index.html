<!DOCTYPE html>
<html lang="pt-br">
<!-- Define o idioma da página como português do Brasil -->

<head>
    <meta charset="utf-8"> <!-- Codificação de caracteres para suportar acentuação -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Torna o layout responsivo para dispositivos móveis -->
    <title> Invaders</title> <!-- Título da aba do navegador -->

    <!-- Bootstrap CSS (para layout responsivo e componentes prontos) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <styles>
        body{
        background-attachment: fixed;
        background-image: url("background4.jpg");
        background-size: cover;
        }
        .nave{
        max-width: 100px;
        max-height: 150px;
        width: auto;
        height: auto;
        }

        .shadow-custom {
        box-shadow: 10px 10px 20px rgba(0, 0, 0, 0.3); /* Aplique a sombra com mais controle */
        }
        .clock{
        max-width: 70px;
        max-height: 70px;
        width: auto;
        height: auto;
        }
        .missil{
        max-width: 55px;
        max-height: 55px;
        width: auto;
        height: auto;
        }

        .painel-informativo {
        color: white;
        background-color: transparent;
        border: 1px solid white;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 70%;
        box-shadow: 1px 1px 10px 4px rgba(240, 233, 233, 0.7);
        }


        #missil1, #missil2 {
        position: absolute;
        bottom: 100px;
        left: 50%;
        width: 30px;
        height: 100px;

        opacity: 0;
        transform: translateY(0);
        transition: transform 0.4s linear, opacity 0.2s ease-out;
        pointer-events: none;
        }


        .alien {
        position: absolute;
        width: 60px;
        height: 60px;
        pointer-events: none;
        }
    </styles>
</head>

<body class="m-0 p-0" style="height: 100vh;" onload="startCounter()">
    <!-- O corpo da página tem altura total da tela, sem margens e paddings. Ao carregar, executa a função de iniciar o cronômetro -->

    <div class="container-fluid px-0 h-100">
        <!-- Container principal que ocupa toda a altura da tela e não tem padding horizontal -->
        <div class="row g-0 h-50">
            <!-- Primeira metade da tela -->
            <div class="col-2 h-100">
                <!-- Coluna lateral com 2/12 da largura, usada como painel de informações -->
                <div class="col painel-informativo">
                    <!-- Painel informativo customizado -->
                    <!-- Relógio do jogo -->
                    <div class="row d-flex align-items-center mb-3">
                        <!-- Alinha verticalmente os elementos -->
                        <img class="clock me-2" src="clock.png" alt=""> <!-- Ícone de relógio -->
                        <div class="col-4">
                            <h3 id="v">0</h3>
                        </div> <!-- Tempo do jogo aparece aqui -->
                    </div>

                    <!-- Vidas do jogador -->
                    <div class="row d-flex align-items-center mb-3">
                        <img class="missil me-3" src="nave.png" alt=""> <!-- Ícone da nave representando vidas -->
                        <div class="col-4">
                            <h3 id="life">LIFE:3</h3>
                        </div> <!-- Quantidade de vidas restante -->
                    </div>

                    <!-- Pontuação (aliens destruídos) -->
                    <div class="row d-flex align-items-center ">
                        <img class="missil" style="max-width: 75px;" src="alien.png" alt=""> <!-- Ícone de alien -->
                        <div class="col-4">
                            <h3>ALIEN:<span id="pontuacao">0</span></h3>
                        </div> <!-- Pontuação dos aliens -->
                    </div>
                </div>
            </div>

            <div class="col-10 text-white">
                <!-- Área principal com 10/12 da largura para os aliens aparecerem -->
                <div id="alien-container" class="position-relative w-100 h-100"></div>
                <!-- Container onde os aliens serão posicionados dinamicamente -->
            </div>
        </div>

        <div class="row g-0 h-50">
            <!-- Segunda metade da tela -->
            <div class="col d-flex text-center align-items-end justify-content-center">
                <!-- Centraliza a nave horizontal e verticalmente -->
                <div class="naveContainer">
                    <!-- Container da nave e mísseis -->
                    <img class="missel img-fluid" src="missil.png" alt="missel-top"
                        style="transition: transform 0.2s ease;" id="missil1"> <!-- Primeiro míssil (lado esquerdo) -->
                    <img class="nave img-fluid" src="nave.png" alt="nave-top" style="transition: transform 0.2s ease;">
                    <!-- Imagem da nave -->
                    <img class="missel img-fluid" src="missil.png" alt="missel-top"
                        style="transition: transform 0.2s ease;" id="missil2"> <!-- Segundo míssil (lado direito) -->
                </div>
            </div>
        </div>
    </div>

    <!-- Overlay de pausa (fica visível quando o jogo é pausado com "p") -->
    <div id="pause-overlay"
        style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); color: white; z-index: 9999; justify-content: center; align-items: center; text-align: center;">
        <h1>Pause</h1> <!-- Texto exibido durante a pausa -->
    </div>

    <!-- Importa o script do jogo -->
    <script>
        // ------------------------------
        // Variáveis Globais
        // ------------------------------
        let val = 0; // Armazena o tempo em segundos desde o início do jogo
        let id; // Identificador do setInterval do cronômetro (usado para pausar)
        let isPaused = false; // Indica se o jogo está pausado
        let flag = 0; // Variável de controle (reserva, pode ser usada depois)
        let pontuacao = 0; // Contador de pontuação do jogador
        let vidas = 3; // Número inicial de vidas do jogador
        let direcao = 1; // Direção atual dos aliens: 1 = direita, -1 = esquerda
        let descidaPendente = false; // Indica se os aliens devem descer (usada na movimentação)

        // ------------------------------
        // Funções de Cronômetro
        // ------------------------------
        function add() {
            val++; // Incrementa o tempo (1 segundo)
            const hours = Math.floor(val / 3600); // Converte para horas
            const minutes = Math.floor((val % 3600) / 60); // Minutos restantes
            const seconds = val % 60; // Segundos restantes

            // Formata no padrão HH:MM:SS com dois dígitos
            const formattedTime = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;

            // Atualiza o elemento com ID "v" na tela
            document.querySelector("#v").textContent = formattedTime;
        }

        function startCounter() {
            id = setInterval(add, 1000); // Chama add() a cada 1 segundo
        }

        function stopCounter() {
            clearInterval(id); // Pausa o cronômetro
        }

        // ------------------------------
        // Movimento da Nave
        // ------------------------------
        const nave = document.querySelector(".nave"); // Seleciona a nave
        let position = 0; // Posição horizontal da nave

        document.addEventListener("keydown", (event) => {
            if (event.key.toLowerCase() === "p") {
                togglePause(); // Alterna pausa ao pressionar "p"
                return;
            }

            if (isPaused) return; // Se pausado, não move a nave

            const step = 10; // Quantidade de movimento por tecla
            const containerWidth = window.innerWidth;
            const naveWidth = nave.offsetWidth;

            if (event.key === "ArrowRight") {
                position += step; // Move para a direita
                nave.style.transform = `translateX(${position}px)`;
            } else if (event.key === "ArrowLeft") {
                position -= step; // Move para a esquerda
                nave.style.transform = `translateX(${position}px)`;
            }
        });

        // ------------------------------
        // Alternar Pausa
        // ------------------------------
        function togglePause() {
            const pauseOverlay = document.querySelector("#pause-overlay"); // Tela de pausa

            if (!isPaused) {
                stopCounter(); // Pausa tempo
                isPaused = true;
                pauseOverlay.style.display = "flex"; // Mostra overlay
            } else {
                startCounter(); // Continua tempo
                isPaused = false;
                pauseOverlay.style.display = "none"; // Esconde overlay
            }
        }

        // ------------------------------
        // Função de Tiro
        // ------------------------------
        function atirar(tecla) {
            if (isPaused) return;

            const naveRect = nave.getBoundingClientRect(); // Posição atual da nave
            const naveCenter = naveRect.left + naveRect.width / 2; // Centro horizontal da nave
            const deslocamento = 30; // Distância do centro até cada míssil
            let missil;

            // Seleciona qual míssil usar baseado na tecla
            if (tecla === "a") {
                missil = document.getElementById("missil1");
            } else if (tecla === "d") {
                missil = document.getElementById("missil2");
            }

            if (!missil) return;

            // Posiciona o míssil e aplica animações
            missil.style.left = `${naveCenter + (tecla === "a" ? -deslocamento : deslocamento) - missil.offsetWidth / 2}px`;
            missil.style.transition = "none";
            missil.style.transform = "translateY(0)";
            missil.style.opacity = "1";
            void missil.offsetWidth; // Força o navegador a aplicar mudanças antes da animação

            // Aplica animação de subida
            missil.style.transition = "transform 0.4s linear, opacity 0.2s ease-out";
            missil.style.transform = "translateY(-600px)";

            // Verifica colisão durante o trajeto
            const intervaloColisao = setInterval(() => {
                detectarColisao(missil);
            }, 50);

            // Após 400ms, o míssil desaparece e volta para a posição inicial
            setTimeout(() => {
                missil.style.opacity = "0";
                missil.style.transform = "translateY(0)";
                clearInterval(intervaloColisao);
            }, 400);
        }

        // Dispara os mísseis com as teclas A e D
        document.addEventListener("keydown", (event) => {
            if (event.key.toLowerCase() === "a") {
                atirar("a");
            } else if (event.key.toLowerCase() === "d") {
                atirar("d");
            }
        });

        // ------------------------------
        // Criar Aliens
        // ------------------------------
        function criarAliens() {
            const container = document.getElementById("alien-container"); // Área dos aliens
            const rows = 3;
            const cols = 8;
            const spacingX = 80;
            const spacingY = 80;

            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    const alien = document.createElement("img");
                    alien.src = "alien.png";
                    alien.classList.add("alien");
                    alien.style.left = `${j * spacingX + 150}px`; // Posição horizontal
                    alien.style.top = `${i * spacingY + 20}px`; // Posição vertical
                    container.appendChild(alien);
                }
            }
        }

        // ------------------------------
        // Detectar Colisão
        // ------------------------------
        function detectarColisao(missil) {
            const missilRect = missil.getBoundingClientRect();
            const aliens = document.querySelectorAll(".alien");

            aliens.forEach((alien) => {
                const alienRect = alien.getBoundingClientRect();
                const colidiu =
                    missilRect.left < alienRect.right &&
                    missilRect.right > alienRect.left &&
                    missilRect.top < alienRect.bottom &&
                    missilRect.bottom > alienRect.top;

                if (colidiu) {
                    alien.remove(); // Remove o alien atingido
                    pontuacao += 1;
                    document.getElementById("pontuacao").textContent = pontuacao; // Atualiza score
                }
            });
        }

        // ------------------------------
        // Mover Aliens
        // ------------------------------
        function moverAliens() {
            if (isPaused) return;

            const aliens = document.querySelectorAll(".alien");
            let moveParaBaixo = false;

            // Verifica se algum alien tocou a borda
            aliens.forEach(alien => {
                const alienRect = alien.getBoundingClientRect();
                if ((direcao === 1 && alienRect.right >= window.innerWidth - 10) ||
                    (direcao === -1 && alienRect.left <= 10)) {
                    moveParaBaixo = true;
                }
            });

            // Move os aliens
            aliens.forEach(alien => {
                let leftAtual = parseFloat(alien.style.left) || 0;
                let topAtual = parseFloat(alien.style.top) || 0;

                if (moveParaBaixo) {
                    alien.style.top = `${topAtual + 20}px`; // Desce os aliens
                } else {
                    alien.style.left = `${leftAtual + (10 * direcao)}px`; // Move lateralmente
                }
            });

            if (moveParaBaixo) {
                direcao *= -1; // Inverte direção
            }
        }

        // ------------------------------
        // Atualizar Vidas na Tela
        // ------------------------------
        function atualizarPlacarDeVidas() {
            document.getElementById("life").textContent = `LIFE:${vidas}`; // Mostra vidas
        }

        // ------------------------------
        // Inicialização do Jogo
        // ------------------------------
        window.onload = () => {
            startCounter(); // Inicia o cronômetro
            criarAliens(); // Cria os inimigos
            setInterval(moverAliens, 500); // Move os aliens a cada 500ms
        };
    </script>


</body>

</html>